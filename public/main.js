const x=(e="")=>e.replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[t]),U=e=>{if(typeof e!="string")return+e||0;const t=e.replace(/[^0-9.\-]/g,"");return parseFloat(t)||0},N=e=>(e||"").toLowerCase().replace(/[_\s]/g,""),q=e=>{for(let t=e.length-1;t>0;t--){const o=Math.random()*(t+1)|0;[e[t],e[o]]=[e[o],e[t]]}return e};function H(e){const t=o=>o.map(s=>e.findIndex(a=>a.includes(s))).find(s=>s!==-1);return{displayCol:t(["playername","fullname","full_name","player","name_display","name"]),lastCol:t(["surname","lname","last"]),firstCol:t(["fname","first","forename","given"]),salaryCol:t(["price","salary","cost","value"]),posCol:t(["position","pos"]),teamCol:t(["club","team"]),statusCol:t(["lineup","status"]),idCol:t(["playerid","pid","id"])}}function T(e){return/\d{3,}/.test((e||"").replace(/[.,\s]/g,""))}function oe(e,t){const o=t.displayCol!==-1?(e[t.displayCol]||"").trim():"",s=t.firstCol!==-1?(e[t.firstCol]||"").trim():"",a=t.lastCol!==-1?(e[t.lastCol]||"").trim():"";let l="";return o?!o.includes(" ")&&a&&!T(a)?l=`${o} ${a}`:l=o:l=s&&a?`${s} ${a}`:a||s,(!l||T(l))&&(s&&!T(s)&&(l=s),a&&!T(a)&&(l=l?`${l} ${a}`:a)),(l||"").trim()}function _(e){const t=e.split(/\r?\n/)[0]||"",o=t.split(";").length-1>t.split(",").length-1?";":",",s=e.split(/\r?\n/).filter(l=>l.trim().length),a=[];for(const l of s){let c="",r=!1;const i=[];for(let p=0;p<l.length;p++){const f=l[p],y=l[p+1];f==='"'?r&&y==='"'?(c+='"',p++):r=!r:f===o&&!r?(i.push(c.trim()),c=""):c+=f}i.push(c.trim()),a.push(i)}return a}function B(e,t){return e==="nfl"?t==="showdown":e==="football"||e==="golf"||e==="f1"}function K(e,t){const o={DEF:"DEFENDER",MID:"MIDFIELDER",FWD:"FORWARD",GK:"GOALKEEPER"},s=[];for(let a=1;a<e.length;a++){const l=e[a];if(!l||!l.length)continue;const c=oe(l,t);if(!c||T(c))continue;const r=U(l[t.salaryCol]);if(r<=0)continue;const i=t.idCol!==-1?(l[t.idCol]||"").trim():`p_${a}`,p=t.teamCol!==-1?(l[t.teamCol]||"").trim():"";let f=t.posCol!==-1?(l[t.posCol]||"").trim().toUpperCase():"";f=o[f]||f;let y="expected";if(t.statusCol!==-1){const u=(l[t.statusCol]||"").toLowerCase();u.includes("possible")?y="possible":(u.includes("unexpected")||u.includes("doubt"))&&(y="unexpected")}s.push({id:i,name:c,first:"",last:"",team:p,position:f,salary:r,status:y,selected:y==="expected",captain:!1})}return s}const F={nfl_full:{label:"NFL â€” Full slate",sport:"nfl",contest:"full-slate",tournament:"Tournament 1008839 (413 players)",eventName:"NFL Example Slate",url:"public/demo/1008839_players_20250906222543.csv"},nfl_show:{label:"NFL â€” Showdown",sport:"nfl",contest:"showdown",tournament:"Tournament 1009037 (33 players)",eventName:"NFL Showdown (Single Game)",url:"public/demo/1009037_players_20250908102649.csv"},fb_full:{label:"Football â€” Full slate",sport:"football",contest:"full-slate",tournament:"Tournament 1009899 (845 players)",eventName:"Champions League Night",url:"public/demo/1009899_players_20250908161603.csv"},fb_show:{label:"Football â€” Showdown",sport:"football",contest:"showdown",tournament:"Tournament 1010808 (51 players)",eventName:"Football Showdown",url:"public/demo/1010808_players_20250908161619.csv"},f1_full:{label:"F1 â€” Race weekend",sport:"f1",contest:"full-slate",tournament:"Tournament 1008665 (29 players)",eventName:"F1 Race Weekend",url:"public/demo/1008665_players_20250906172857.csv"},golf_full:{label:"Golf â€” PGA tournament",sport:"golf",contest:"full-slate",tournament:"Tournament 1000000 (585 players)",eventName:"PGA Tournament",url:"public/demo/1000000_players_20250815093906.csv"}},$=["nfl_full","nfl_show","fb_full","fb_show","f1_full","golf_full"];let O=-1;const I={nfl:{name:"NFL",icon:"ðŸˆ",lineupSize:9,positions:["QUARTERBACK","RUNNING_BACK","WIDE_RECEIVER","TIGHT_END","DST"],salaryRange:[118,120],currency:"Â£",fullSlateSize:846,showdownSize:52},football:{name:"Football/Soccer",icon:"âš½",lineupSize:6,positions:["GOALKEEPER","DEFENDER","MIDFIELDER","FORWARD"],salaryRange:[98,100],currency:"Â£",fullSlateSize:414,showdownSize:30},golf:{name:"Golf",icon:"ðŸŒï¸",lineupSize:6,positions:["PLAYER"],salaryRange:[98,100],currency:"Â£",fullSlateSize:69,showdownSize:69},f1:{name:"Formula 1",icon:"ðŸŽï¸",lineupSize:6,positions:["DRIVER","CONSTRUCTOR"],salaryRange:[100,102],currency:"Â£",fullSlateSize:34,showdownSize:34}},n={currentStep:1,players:[],lineups:[],detectedSport:"nfl",contestType:"full-slate",currentDemoSport:"nfl",datasetMeta:{tournament:"",eventName:""},isDemo:!1,statusFilter:"",sort:{field:"",dir:"asc"}};function g(e,t="success"){const o=document.createElement("div");o.className=`toast ${t}`,o.textContent=e,document.body.appendChild(o),setTimeout(()=>o.remove(),3e3)}function se(e){if(!e||!e.length)return"nfl";const t=[...new Set(e.map(r=>N(r.position)))],o=e.reduce((r,i)=>r+(i.salary||0),0)/e.length,s=e.length,a=["quarterback","runningback","widereceiver","tightend","dst","defense","qb","rb","wr","te"];if(t.some(r=>a.includes(r)))return n.contestType=s>100?"full-slate":"showdown","nfl";const l=["defender","midfielder","forward","goalkeeper","gk","def","mid","fwd"];if(t.some(r=>l.includes(r)))return n.contestType=s>100?"full-slate":"showdown","football";const c=["driver","constructor"];return t.some(r=>c.includes(r))||s>=30&&s<=40?(n.contestType="full-slate","f1"):s>=60&&s<=80?(n.contestType="full-slate","golf"):o>1e3?(n.contestType=s>100?"full-slate":"showdown","nfl"):"football"}async function ae(e){const t=await e.text(),o=_(t);if(o.length<2)throw new Error("CSV needs header + at least 1 data row");const s=o[0].map(c=>N(c)),a=H(s);if(a.salaryCol===-1)throw new Error('Required "Price/Salary" column not found');if(a.displayCol===-1&&a.firstCol===-1&&a.lastCol===-1)throw new Error("Name columns not found (need Name/Player or First/Last)");const l=K(o,a);if(!l.length)throw new Error("No valid players found");return l}async function le(e){try{const t=await e.text(),o=_(t);if(o.length<2)throw new Error("Projection CSV needs header and data");const s=o[0].map(r=>N(r)),a=s.findIndex(r=>["playername","fullname","full_name","player","name"].some(i=>r.includes(i))),l=s.findIndex(r=>["projection","proj","points","fpts","score"].some(i=>r.includes(i)));if(a===-1||l===-1)throw new Error("Projection CSV missing name or projection column");let c=0;for(let r=1;r<o.length;r++){const i=(o[r][a]||"").trim(),p=U(o[r][l]),f=n.players.find(y=>y.name.toLowerCase()===i.toLowerCase());f&&(f.projection=p,c++)}g(`Loaded projections for ${c} players`,"success"),E()}catch(t){g(t.message,"error")}}async function z(e){n.isDemo=!0;const t=F[e];if(!t)throw new Error(`Unknown demo key: ${e}`);const o=await fetch(t.url);if(!o.ok)throw new Error(`Failed to fetch ${t.url}`);const s=await o.text(),a=_(s);if(a.length<2)throw new Error(`Demo "${e}" CSV appears empty.`);const l=a[0].map(i=>N(i)),c=H(l);if(c.salaryCol===-1)throw new Error("Demo missing required columns (Price/Salary).");return{players:K(a,c),sport:t.sport,contest:t.contest,tournament:t.tournament,eventName:t.eventName}}function D(e,t){const o=Object.entries(F).find(([,s])=>s.sport===e&&s.contest===t)||Object.entries(F).find(([,s])=>s.sport===e);return o?o[0]:null}function C(e){[1,2,3,4].forEach(t=>{const o=document.getElementById(`step${t}`),s=document.getElementById(`ps${t}`),a=document.getElementById(`sn${t}`);o&&o.classList.toggle("active",t===e&&t<=3),s&&a&&(s.classList.remove("active","completed"),a.classList.remove("active","completed"),t<e?(s.classList.add("completed"),a.classList.add("completed")):t===e&&(s.classList.add("active"),a.classList.add("active")))}),document.getElementById("main").classList.toggle("active",e===4),n.currentStep=e,W()}function j(){const e=I[n.detectedSport],t=n.players.length;if(document.getElementById("playerCount").textContent=t,document.getElementById("detectedSport").textContent=e.name,document.getElementById("detectedContest").textContent=n.contestType==="showdown"?"Showdown":"Full slate",document.getElementById("sportSelector").value=n.detectedSport,document.getElementById("metaTournament").textContent=n.datasetMeta.tournament||"â€”",document.getElementById("metaEvent").textContent=n.datasetMeta.eventName||"â€”",t){const o=n.players.map(c=>c.salary).filter(c=>c>0),s=Math.min(...o),a=Math.max(...o);document.getElementById("salaryRange").textContent=`${e.currency}${Math.round(s)} - ${e.currency}${Math.round(a)}`;const l=[...new Set(n.players.map(c=>c.position).filter(Boolean))];document.getElementById("commonPositions").textContent=l.slice(0,6).join(", ")}else document.getElementById("salaryRange").textContent=`${e.currency}0 - ${e.currency}0`,document.getElementById("commonPositions").textContent="â€”"}function b(){const e=n.players.filter(o=>o.selected).length,t=n.players.filter(o=>o.captain).length;document.getElementById("selectedCount").textContent=e,document.getElementById("captainCount").textContent=t,document.getElementById("statPlayers").textContent=n.players.length}function W(){const e=document.getElementById("captainAll"),t=B(n.detectedSport,n.contestType);e&&(e.disabled=!t);const o=I[n.detectedSport],s=+document.getElementById("minSalary").value||o.salaryRange[0],a=+document.getElementById("maxSalary").value||o.salaryRange[1],l=t?"Captain required":"No captain";document.getElementById("constraintsText").textContent=`${o.name} â€¢ ${n.contestType} â€¢ Lineup size ${o.lineupSize} â€¢ ${l} â€¢ Salary ${o.currency}${s}â€“${o.currency}${a}`}function re(){const e=document.getElementById("positionFilter");e.innerHTML='<option value="">All positions</option>',[...new Set(n.players.map(a=>a.position).filter(Boolean))].sort().forEach(a=>{const l=document.createElement("option");l.value=a,l.textContent=a,e.appendChild(l)});const o=document.getElementById("teamFilter");o.innerHTML='<option value="">All teams</option>',[...new Set(n.players.map(a=>a.team).filter(Boolean))].sort().forEach(a=>{const l=document.createElement("option");l.value=a,l.textContent=a,o.appendChild(l)}),n.sort={field:"",dir:"asc"},n.statusFilter=""}function ce(){const e=document.getElementById("searchPlayers").value.toLowerCase(),t=document.getElementById("positionFilter").value,o=document.getElementById("teamFilter").value,s=n.statusFilter;let a=n.players.filter(l=>{const c=!e||l.name.toLowerCase().includes(e),r=!t||l.position===t,i=!o||l.team===o,p=!s||l.status===s;return c&&r&&i&&p});if(n.sort.field){const l=n.sort.dir==="asc"?1:-1;n.sort.field==="salary"?a.sort((c,r)=>(c.salary-r.salary)*l):n.sort.field==="proj"&&a.sort((c,r)=>((c.projection??-1/0)-(r.projection??-1/0))*l)}return a}function ie(){Object.entries({proj:"thProj",salary:"thSalary"}).forEach(([t,o])=>{const s=document.getElementById(o);if(!s)return;const a=t==="proj"?"Proj":"Salary";n.sort.field===t?(s.innerHTML=a+(n.sort.dir==="asc"?" â–²":" â–¼"),s.classList.add("active")):(s.innerHTML=a,s.classList.remove("active"))})}function Q(e){n.sort.field===e?n.sort.dir=n.sort.dir==="asc"?"desc":"asc":(n.sort.field=e,n.sort.dir="desc"),E()}function E(){ie();const e=I[n.detectedSport],t=document.getElementById("playerTableBody");t.innerHTML=ce().map(o=>`<tr class="${o.status==="expected"?"row-expected":o.status==="possible"?"row-possible":"row-unexpected"}">
  <td><input type="checkbox" ${o.selected?"checked":""} onchange="toggleSelected('${o.id}')" /></td>
  <td><input type="checkbox" ${o.captain?"checked":""} ${B(n.detectedSport,n.contestType)?"":"disabled"} onchange="toggleCaptain('${o.id}')" /></td>
  <td>${x(o.name)}</td>
  <td>${x(o.position)}</td>
  <td>${x(o.team||"")}</td>
  <td>${o.projection!=null?o.projection.toFixed(2):""}</td>
  <td>${e.currency}${o.salary}</td>
  <td><span class="helper" style="color:${o.status==="expected"?"#2fe089":o.status==="possible"?"#ffb86c":"#ff6b6b"}">${o.status}</span></td>
</tr>`).join("")}function Z(){const e=I[n.detectedSport],t=document.getElementById("lineupTableBody"),o=B(n.detectedSport,n.contestType);t.innerHTML=n.lineups.map(s=>{var a;return`<tr>
  <td>${s.id}</td>
  <td>${x(o?((a=s.captain)==null?void 0:a.name)||"":"â€”")}</td>
  <td>${s.players.map(l=>x(l.name)).join(", ")}</td>
  <td>${e.currency}${s.totalSalary}</td>
</tr>`}).join(""),document.getElementById("lineupResults").textContent=n.lineups.length,ue(),document.getElementById("downloadBtn").toggleAttribute("disabled",n.lineups.length===0)}const de=e=>e.map(t=>`"${String(t).replace(/"/g,'""')}"`).join(",");function ue(){const e=I[n.detectedSport],t=B(n.detectedSport,n.contestType),o=Array.from({length:e.lineupSize},(r,i)=>`Player${i+1}`);t&&o.push("Captain");const s=[o];n.lineups.forEach(r=>{var p;const i=r.players.map(f=>f.name);for(;i.length<e.lineupSize;)i.push("");t&&i.push(((p=r.captain)==null?void 0:p.name)||""),s.push(i)});const a=s.map(de).join(`
`),l=new Blob([a],{type:"text/csv"}),c=document.getElementById("downloadBtn");c.href=URL.createObjectURL(l),n.lineups.length>0?c.removeAttribute("disabled"):c.setAttribute("disabled","")}function me(){const e=I[n.detectedSport],t=B(n.detectedSport,n.contestType),o=n.players.filter(u=>u.selected).sort((u,d)=>d.salary-u.salary);if(o.length<e.lineupSize)throw new Error(`Need â‰¥ ${e.lineupSize} selected players; have ${o.length}.`);let s=[];if(t){if(s=o.filter(u=>u.captain),!s.length)throw new Error("Need at least 1 captain candidate.")}else s=[null];const a=+document.getElementById("lineupCount").value||20,l=+document.getElementById("minSalary").value,c=+document.getElementById("maxSalary").value,r=new Set,i=[],p=u=>{const d=[];let w=0;u&&(d.push(u),w+=u.salary);const M=q(o.filter(m=>!u||m.id!==u.id));for(const m of M){if(d.length>=e.lineupSize)break;w+m.salary<=c&&(d.push(m),w+=m.salary)}if(d.length<e.lineupSize){for(const m of M)if(!d.find(h=>h.id===m.id)&&(d.push(m),w+=m.salary,d.length>=e.lineupSize))break}for(d.sort((m,h)=>h.salary-m.salary);d.length>e.lineupSize;){const m=d.reduce((h,L,v)=>L.salary<d[h].salary?v:h,0);w-=d[m].salary,d.splice(m,1)}let A=!0,V=0;for(;A&&V<200;){A=!1,V++;const m=d.reduce((v,P,ne)=>P.salary<d[v].salary?ne:v,0),h=d[m],L=M.find(v=>!d.find(P=>P.id===v.id)&&w-h.salary+v.salary<=c&&v.salary>h.salary);L&&(w=w-h.salary+L.salary,d[m]=L,A=!0)}if(d.length===e.lineupSize&&w>=l&&w<=c){const m=d.map(h=>h.id).sort().join("|")+(u?`|C:${u.id}`:"");r.has(m)||(r.add(m),i.push({id:i.length+1,players:d,captain:u,totalSalary:w}))}},f=a*s.length*50;let y=0;for(const u of s){for(;i.length<a&&y<f;){const d=i.length;p(u),y++,i.length>d&&i.length<a&&q(o)}if(i.length>=a||y>=f)break}if(!i.length)throw new Error("No valid lineups; lower Min or raise Max salary.");return i.length<a&&g(`Generated ${i.length}/${a} lineups after ${y} attempts. Consider adjusting salary limits or captain pool.`,"warn"),{lineups:i,attempts:y}}function pe(){const e=I[n.detectedSport],t=n.players.filter(r=>r.selected),a=[...t.length>=e.lineupSize?t:n.players].sort((r,i)=>i.salary-r.salary).slice(0,e.lineupSize).reduce((r,i)=>r+i.salary,0),l=Math.max(0,Math.floor(a*.9)),c=Math.ceil(a);document.getElementById("minSalary").value=l,document.getElementById("maxSalary").value=c}const S=document.getElementById("uploadZone"),J=document.getElementById("fileInput");S.addEventListener("click",()=>J.click());S.addEventListener("dragover",e=>{e.preventDefault(),S.classList.add("dragover")});S.addEventListener("dragleave",()=>S.classList.remove("dragover"));S.addEventListener("drop",e=>{e.preventDefault(),S.classList.remove("dragover");const t=e.dataTransfer.files;t.length&&X(t[0])});J.addEventListener("change",e=>{e.target.files.length&&X(e.target.files[0])});async function X(e){try{const t=await ae(e);n.players=t,n.detectedSport=se(t),n.datasetMeta={tournament:e.name.replace(/\.csv$/i,""),eventName:"Imported CSV"},n.isDemo=!1,S.classList.add("has-file"),g(`Loaded ${t.length} players`,"success"),j(),C(2)}catch(t){g(t.message,"error")}}document.getElementById("demoBtn").addEventListener("click",async()=>{try{O=(O+1)%$.length;const e=$[O],t=await z(e);n.players=t.players,n.detectedSport=t.sport,n.currentDemoSport=t.sport,n.contestType=t.contest,n.datasetMeta={tournament:t.tournament,eventName:t.eventName},n.isDemo=!0,j(),g(`Demo loaded: ${F[e].label} (${t.players.length} players)`),C(2)}catch(e){g(e.message,"error")}});document.getElementById("backToUpload").addEventListener("click",()=>C(1));const k=document.getElementById("optFull"),R=document.getElementById("optShow");function Y(){[k,R].forEach(e=>e.classList.remove("selected")),(n.contestType==="showdown"?R:k).classList.add("selected")}document.getElementById("sportSelector").addEventListener("change",async e=>{if(n.detectedSport=e.target.value,!!n.isDemo)try{const t=n.contestType,o=D(n.detectedSport,t)||D(n.detectedSport,"full-slate");if(o){const s=await z(o);n.players=s.players,n.contestType=s.contest,n.datasetMeta={tournament:s.tournament,eventName:s.eventName},n.currentDemoSport=s.sport,j(),Y()}}catch(t){g(t.message,"error")}});document.getElementById("confirmSport").addEventListener("click",async()=>{try{if(n.detectedSport=document.getElementById("sportSelector").value,n.isDemo){const e=n.contestType,t=D(n.detectedSport,e)||D(n.detectedSport,"full-slate");if(t){const o=await z(t);n.players=o.players,n.contestType=o.contest,n.currentDemoSport=o.sport,n.datasetMeta={tournament:o.tournament,eventName:o.eventName},j()}}Y(),C(3)}catch(e){g(e.message,"error")}});document.getElementById("backToSport").addEventListener("click",()=>C(2));[k,R].forEach(e=>e.addEventListener("click",()=>{[k,R].forEach(t=>t.classList.remove("selected")),e.classList.add("selected"),n.contestType=e.dataset.type}));document.getElementById("confirmContest").addEventListener("click",()=>{const e=I[n.detectedSport];document.getElementById("statSport").textContent=e.name,document.getElementById("statContest").textContent=n.contestType==="showdown"?"Showdown":"Full slate",pe(),re(),b(),E(),W(),C(4)});document.getElementById("generateBtn").addEventListener("click",()=>{try{const e=me();n.lineups=e.lineups,Z();const t=+document.getElementById("lineupCount").value||20;n.lineups.length>=t&&g(`Generated ${n.lineups.length} lineups!`,"success")}catch(e){g(e.message,"error")}});document.getElementById("selectAll").addEventListener("click",()=>{n.players.forEach(e=>e.selected=!0),n.statusFilter="",b(),E()});document.getElementById("selectNone").addEventListener("click",()=>{n.players.forEach(e=>{e.selected=!1,e.captain=!1}),n.statusFilter="",b(),E()});document.getElementById("selectExpected").addEventListener("click",()=>{n.players.forEach(e=>{e.selected=e.status==="expected",e.selected||(e.captain=!1)}),n.statusFilter="expected",b(),E()});document.getElementById("captainAll").addEventListener("click",()=>{B(n.detectedSport,n.contestType)&&(n.players.filter(e=>e.selected).forEach(e=>e.captain=!0),b(),E())});document.getElementById("clearResults").addEventListener("click",()=>{n.lineups=[],Z()});document.getElementById("startOver").addEventListener("click",()=>{n.players=[],n.lineups=[],n.currentDemoSport="nfl",n.datasetMeta={tournament:"",eventName:""},n.isDemo=!1,document.getElementById("downloadBtn").setAttribute("disabled",""),S.classList.remove("has-file"),C(1)});document.getElementById("searchPlayers").addEventListener("input",E);document.getElementById("positionFilter").addEventListener("change",E);document.getElementById("teamFilter").addEventListener("change",E);document.getElementById("thProj").addEventListener("click",()=>Q("proj"));document.getElementById("thSalary").addEventListener("click",()=>Q("salary"));document.getElementById("importProj").addEventListener("click",()=>document.getElementById("projInput").click());document.getElementById("projInput").addEventListener("change",e=>{e.target.files.length&&le(e.target.files[0])});window.toggleSelected=e=>{const t=n.players.find(o=>o.id===e);t&&(t.selected=!t.selected,t.selected||(t.captain=!1),b(),E())};window.toggleCaptain=e=>{const t=n.players.find(o=>o.id===e);t&&B(n.detectedSport,n.contestType)&&(t.captain=!t.captain,t.captain&&(t.selected=!0),b(),E())};(function(){try{console.assert(Array.isArray($)&&$.every(t=>typeof t=="string"),"DEMO_ROTATION must be array of keys"),console.assert($.every(t=>F[t]),"All DEMO_ROTATION keys must exist in DEMO_CSVS"),console.assert(typeof _=="function"&&typeof N=="function","Parsers present")}catch(t){console.warn("Self-test failed:",t)}})();(function(){C(1),console.log("FanTeam DFS Optimizer â€” MVP v2 ready")})();let fe=null,G="free";async function ye(e,t){const o=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok){const s=await o.text();throw new Error(s||"Request failed")}return o.json()}function ee(){const e=document.getElementById("generateBtn");e&&(G==="free"?(e.setAttribute("disabled",""),e.title="Upgrade to Pro to use this feature"):(e.removeAttribute("disabled"),e.title=""))}function ge(e){document.getElementById("userDisplay").textContent=e,document.getElementById("tierDisplay").textContent=G,document.getElementById("loginForm").style.display="none",document.getElementById("userInfo").style.display="block"}async function te(e){try{const t=document.getElementById("username").value,o=document.getElementById("password").value,s=document.getElementById("tier").value,a=await ye(e,{username:t,password:o,tier:s});fe=a.token,G=a.tier,ge(t),ee(),g("Authenticated","success")}catch(t){g(t.message,"error")}}document.getElementById("loginBtn").addEventListener("click",()=>te("/api/auth/login"));document.getElementById("registerBtn").addEventListener("click",()=>te("/api/auth/register"));ee();
