<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FanTeam DFS Optimizer ‚Äî MVP v2</title>
<style>
:root{--bg:#0b0e13;--panel:#121723;--mut:#8aa0c9;--text:#e8ecf6;--accent:#2fe089;--warn:#ffb86c;--err:#ff6b6b;--success:#2fe089;--br:14px}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto;overflow-x:hidden}
header{padding:20px;text-align:center;border-bottom:1px solid #1b2131;background:linear-gradient(180deg,#121723,#0b0e13)}
h1{margin:0;font-size:24px;color:var(--accent);font-weight:600}
.subtitle{color:var(--mut);margin-top:8px;font-size:14px}
.container{max-width:960px;margin:0 auto;padding:40px 20px}
small.mono{font-family:ui-monospace,Menlo,Consolas,monospace;color:#9fb2dc}
.progress-steps{display:flex;justify-content:center;gap:20px;margin:20px 0}
.progress-step{display:flex;align-items:center;gap:8px;color:var(--mut);font-size:12px}
.progress-step.active{color:var(--accent)}
.progress-step.completed{color:var(--success)}
.step-number{width:24px;height:24px;border-radius:50%;background:#1a2438;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:600}
.step-number.active{background:var(--accent);color:#0b291a}
.step-number.completed{background:var(--success);color:#0b291a}
.step{display:none;text-align:left}
.step.active{display:block}
.step h2{color:var(--accent);margin-bottom:12px;font-size:20px}
.step p{color:var(--mut);margin-bottom:16px;line-height:1.6}
.upload-zone{border:2px dashed #344155;border-radius:12px;padding:40px 24px;margin:16px 0;cursor:pointer;transition:all .2s;background:rgba(26,36,56,.25)}
.upload-zone:hover,.upload-zone.dragover{border-color:var(--accent);background:rgba(47,224,137,.08)}
.upload-zone.has-file{border-color:var(--success);background:rgba(47,224,137,.1)}
.upload-icon{font-size:40px;margin-bottom:10px;color:var(--accent);text-align:center}
.upload-text{text-align:center}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;border:1px solid #24314d;background:#10182a;color:#e8ecf6;padding:10px 16px;border-radius:8px;cursor:pointer;font-size:14px;transition:all .15s;text-decoration:none;font-weight:600}
.btn:hover{background:#1a2438;border-color:#2fe089}
.btn.primary{background:linear-gradient(135deg,#2fe089,#1db26a);color:#072615;border-color:#1d8a55}
.btn.primary:hover{filter:brightness(1.05)}
.btn:disabled{opacity:.5;cursor:not-allowed}
.btn-group{display:flex;gap:10px;flex-wrap:wrap}
.detection-result{background:var(--panel);border:1px solid #1b2131;border-radius:8px;padding:12px;margin:12px 0}
.detection-grid{display:grid;grid-template-columns:1fr 2fr;gap:8px;align-items:center}
.label{color:#9db1d9;font-size:12px}
.value{color:#e8ecf6;font-weight:600;font-size:13px}
.sport-selector{background:#0d1220;border:1px solid #20283a;border-radius:8px;padding:12px;color:var(--text);font-size:14px;width:100%;margin:10px 0}
.contest-type{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:14px 0}
.contest-option{background:var(--panel);border:2px solid #1b2131;border-radius:10px;padding:16px;cursor:pointer;transition:all .15s}
.contest-option:hover{border-color:var(--accent)}
.contest-option.selected{border-color:var(--success);background:rgba(47,224,137,.08)}
.main-interface{display:none;max-width:1400px;margin:0 auto;padding:20px}
.main-interface.active{display:grid;grid-template-columns:360px 1fr;gap:16px}
@media(max-width:1100px){.main-interface.active{grid-template-columns:1fr}}
.panel{background:var(--panel);border:1px solid #1b2131;border-radius:var(--br);padding:14px;box-shadow:0 8px 30px rgba(0,0,0,.25)}
.panel h3{margin:0 0 10px 0;font-size:15px;color:var(--accent)}
.stat-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(110px,1fr));gap:8px}
.stat{background:#0d1220;border:1px solid #1e2740;border-radius:8px;padding:8px}
.stat .v{font-weight:700;color:var(--accent)}
.stat .k{font-size:11px;color:#9fb0d7}
.control-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
input[type="number"],input[type="text"],select{background:#0d1220;color:var(--text);border:1px solid #20283a;border-radius:8px;padding:8px;font-size:13px;width:100%}
label{display:block;margin:6px 0 4px;color:#aab2cd;font-size:12px}
.scroller{max-height:420px;overflow:auto;border:1px solid #1e2740;border-radius:8px;background:#0a0f1a}
.table{width:100%;border-collapse:collapse;font-size:12px}
.table th,.table td{padding:6px 8px;border-bottom:1px solid #20283a;text-align:left}
.table th{position:sticky;top:0;background:#0f1524;z-index:1;color:#c8d2ef;font-weight:600;font-size:11px}
.table th.sortable{cursor:pointer}
.table th.sortable.active{color:var(--accent)}
.row-expected{background:rgba(47,224,137,.06);border-left:3px solid var(--success)}
.row-possible{background:rgba(255,184,108,.06);border-left:3px solid var(--warn)}
.row-unexpected{background:rgba(255,107,107,.06);border-left:3px solid var(--err)}
.searchbar{display:flex;gap:8px;align-items:center;margin-bottom:10px;flex-wrap:wrap}
.toast{position:fixed;top:16px;right:16px;background:var(--panel);border:1px solid #1b2131;padding:12px 14px;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,.3);z-index:1000;max-width:320px}
.toast.success{border-color:var(--success);background:rgba(47,224,137,.08)}
.toast.error{border-color:var(--err);background:rgba(255,107,107,.08)}
.toast.warn{border-color:var(--warn);background:rgba(255,184,108,.08)}
.helper{font-size:12px;color:#aab2cd}
.badge{display:inline-flex;align-items:center;gap:6px;border:1px solid #2a3552;background:#0f1726;border-radius:999px;padding:4px 8px;font-size:11px;color:#c9d5f5}
hr.sep{border:none;border-top:1px solid #1b2131;margin:12px 0}
</style>
</head>
<body>
<header>
  <h1>FanTeam DFS Optimizer ‚Äî MVP</h1>
  <div class="subtitle">European-focused ‚Ä¢ Transparent algorithms ‚Ä¢ Multi-sport ‚Ä¢ FanTeam-ready</div>
</header>
<div class="container" id="authSection">
  <div id="loginForm">
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <select id="tier"><option value="free">Free</option><option value="pro">Pro</option><option value="elite">Elite</option></select>
    <button class="btn" id="registerBtn">Register</button>
    <button class="btn" id="loginBtn">Login</button>
  </div>
  <div id="userInfo" style="display:none;">Logged in as <span id="userDisplay"></span> (<span id="tierDisplay"></span>)</div>
</div>


<div class="container">
  <!-- Progress -->
  <div class="progress-steps">
    <div class="progress-step active" id="ps1"><div class="step-number active" id="sn1">1</div><span>Upload</span></div>
    <div class="progress-step" id="ps2"><div class="step-number" id="sn2">2</div><span>Confirm</span></div>
    <div class="progress-step" id="ps3"><div class="step-number" id="sn3">3</div><span>Contest</span></div>
    <div class="progress-step" id="ps4"><div class="step-number" id="sn4">4</div><span>Optimize</span></div>
  </div>

  <!-- Step 1: Upload -->
  <section class="step active" id="step1">
    <h2>Upload your FanTeam export (CSV)</h2>
    <p class="helper">We‚Äôll auto-detect sport & format. Supports NFL, Football, Golf, F1. The tool applies our validated NFL projection conversion methodology when projections are supplied (placeholder in this MVP).</p>
    <div class="upload-zone" id="uploadZone">
      <div class="upload-icon">üìä</div>
      <div class="upload-text">Drop CSV here or click to browse</div>
      <input type="file" id="fileInput" accept=".csv" hidden />
    </div>
    <div class="badge">Free demo mode available ‚Äî no account required</div>
    <div style="margin-top:12px" class="btn-group">
      <button class="btn" id="demoBtn">Try Demo Data (Cycle sports)</button>
    </div>
  </section>

  <!-- Step 2: Confirm -->
  <section class="step" id="step2">
    <h2>Confirm detection</h2>
    <div class="detection-result">
      <div class="detection-grid">
        <div class="label">Tournament</div><div class="value" id="metaTournament">‚Äî</div>
        <div class="label">Event</div><div class="value" id="metaEvent">‚Äî</div>
        <div class="label">Detected sport</div><div class="value" id="detectedSport">‚Äî</div>
        <div class="label">Contest type</div><div class="value" id="detectedContest">‚Äî</div>
        <div class="label">Players found</div><div class="value" id="playerCount">0</div>
        <div class="label">Salary range</div><div class="value" id="salaryRange">‚Äî</div>
        <div class="label">Positions</div><div class="value" id="commonPositions">‚Äî</div>
      </div>
    </div>

    <label for="sportSelector">Override sport (if needed)</label>
    <select id="sportSelector" class="sport-selector">
      <option value="nfl">üèà NFL</option>
      <option value="football">‚öΩ Football/Soccer</option>
      <option value="golf">üèåÔ∏è Golf</option>
      <option value="f1">üèéÔ∏è Formula 1</option>
    </select>

    <div class="btn-group" style="margin-top:10px">
      <button class="btn" id="backToUpload">‚Üê Back</button>
      <button class="btn primary" id="confirmSport">Continue ‚Üí</button>
    </div>
  </section>

  <!-- Step 3: Contest -->
  <section class="step" id="step3">
    <h2>Select contest format</h2>
    <div class="contest-type">
      <div class="contest-option selected" data-type="full-slate" id="optFull"><strong>Full slate</strong><br><small class="mono">Classic multi-game</small></div>
      <div class="contest-option" data-type="showdown" id="optShow"><strong>Showdown</strong><br><small class="mono">Single game, captain</small></div>
    </div>
    <div class="btn-group">
      <button class="btn" id="backToSport">‚Üê Back</button>
      <button class="btn primary" id="confirmContest">Start optimizing ‚Üí</button>
    </div>
  </section>
</div>

<!-- Step 4: Main interface -->
<section class="main-interface" id="main">
  <aside class="panel">
    <h3>üéØ Contest setup</h3>
    <div class="stat-grid" style="margin-bottom:10px">
      <div class="stat"><div class="v" id="statSport">‚Äî</div><div class="k">Sport</div></div>
      <div class="stat"><div class="v" id="statContest">‚Äî</div><div class="k">Contest</div></div>
      <div class="stat"><div class="v" id="statPlayers">0</div><div class="k">Players</div></div>
    </div>

    <h3>‚öôÔ∏è Lineup settings</h3>
    <div class="control-row">
      <div>
        <label for="lineupCount">Lineups</label>
        <input id="lineupCount" type="number" min="1" max="150" value="20" />
      </div>
      <div>
        <label for="strategy">Strategy</label>
        <select id="strategy">
          <option value="balanced">Balanced</option>
          <option value="safe">Safe</option>
          <option value="aggressive">Aggressive</option>
          <option value="contrarian">Contrarian</option>
        </select>
      </div>
    </div>
    <div class="control-row">
      <div>
        <label for="minSalary">Min salary</label>
        <input id="minSalary" type="number" />
      </div>
      <div>
        <label for="maxSalary">Max salary</label>
        <input id="maxSalary" type="number" />
      </div>
    </div>
    <button class="btn primary" id="generateBtn" style="width:100%;margin-top:10px">üöÄ Generate lineups</button>

    <hr class="sep" />
    <h3>üîç Transparency</h3>
    <div class="stat">
      <div class="k">Constraints applied</div>
      <div class="helper" id="constraintsText">‚Äî</div>
    </div>

    <h3 style="margin-top:10px">üìä Validation</h3>
    <div class="stat-grid">
      <div class="stat"><div class="v" id="selectedCount">0</div><div class="k">Selected</div></div>
      <div class="stat"><div class="v" id="captainCount">0</div><div class="k">Captains</div></div>
      <div class="stat"><div class="v" id="lineupResults">0</div><div class="k">Generated</div></div>
    </div>
  </aside>

  <main class="panel">
    <div class="searchbar">
      <h3 style="margin:0;flex:1">üë• Player management</h3>
      <input id="searchPlayers" type="text" placeholder="Search by name..." style="max-width:180px" />
      <select id="positionFilter" style="max-width:120px"><option value="">All positions</option></select>
      <select id="teamFilter" style="max-width:120px"><option value="">All teams</option></select>
    </div>
    <div class="btn-group" style="margin-bottom:8px">
      <button class="btn" id="selectAll">Select all</button>
      <button class="btn" id="selectNone">Clear all</button>
      <button class="btn" id="selectExpected">Expected only</button>
      <button class="btn" id="captainAll">Captain all</button>
      <button class="btn" id="importProj">Import projections</button>
    </div>
    <input type="file" id="projInput" accept=".csv" hidden />

    <div class="scroller">
      <table class="table">
        <thead>
          <tr>
            <th>‚úì</th>
            <th>C</th>
            <th>Player</th>
            <th>Pos</th>
            <th>Team</th>
            <th id="thProj" class="sortable">Proj</th>
            <th id="thSalary" class="sortable">Salary</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="playerTableBody"></tbody>
      </table>
    </div>

    <h3 style="margin-top:16px">üèÜ Generated lineups</h3>
    <div class="scroller" style="max-height:320px">
      <table class="table">
        <thead>
          <tr>
            <th>#</th>
            <th>Captain</th>
            <th>Players</th>
            <th>Total salary</th>
          </tr>
        </thead>
        <tbody id="lineupTableBody"></tbody>
      </table>
    </div>

    <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
      <a class="btn primary" id="downloadBtn" href="#" download="fanteam_lineups.csv" disabled>üì• Download CSV</a>
      <button class="btn" id="clearResults">Clear results</button>
      <button class="btn" id="startOver">‚Üê Start over</button>
    </div>
  </main>
</section>

<div id="toastContainer"></div>

<script type="module" src="src/main.js"></script>
<script src="auth.js"></script>
</body>
</html>
